## Transform

With the rally data cleaned and standardised, I moved into feature engineering to prepare it for modeling. My aim at this stage was to create variables that could capture meaningful aspects of match context, rally progression, and spatial relationships between players and the shuttle.  

I began by categorising each rally within a set into “early,” “mid,” and “late” phases based on its sequence order. This allowed me to explore whether Chou’s tactics or shot effectiveness shifted as the set wore on, for instance due to fatigue or strategic adaptation. I also standardised tournament names by removing trailing year values so that the same tournament played across different years would be recognised as a single factor level, avoiding fragmentation in later analysis.  

Next, I created a **set-level summary table** by extracting the final stroke of each set, recording the set winner and the final scores for both Chou and his opponent. This served both as a quick reference for performance summaries and as a check that the match flow data matched the recorded results.  

The main focus of this stage, however, was to prepare a dataset for analysing the outcomes of **final strokes in each rally**. Starting from the cleaned `rally_data`, I joined in the relevant match metadata so that each stroke carried information about the tournament, round, year, and opponent. I then grouped the data by match, set, and rally, filtering it down to just the final stroke in each rally. These final strokes were of particular interest because they directly determined rally outcomes.  

For each rally-ending shot, I recoded key variables as factors with meaningful levels and orders. The outcome variable `chou_win` was defined as a binary factor (“win” or “loss”), rounds were ordered from “Group-Stage” through to “Finals,” and the rally phase factor retained its early–mid–late ordering. Shot types, handedness (forehand/backhand), set number, and opponent identity were also converted to factors for consistency in statistical modeling. At this point, I filtered the data further so that it only contained rallies where Chou was the player executing the final stroke, ensuring the spatial features would be defined from his perspective.

With the contextual and categorical variables in place, I turned to spatial transformations. I began by calculating the Euclidean distance between Chou and his opponent at the moment of the final stroke. This distance provided a measure of their relative positioning, which can be crucial in understanding both offensive and defensive situations. To add more spatial detail, I computed the unit vector from Chou to his opponent, as well as its perpendicular counterpart. These vectors formed the basis for a coordinate system anchored to the opponent’s position relative to Chou.  

Using this coordinate system, I then calculated the Euclidean distance between Chou and the shuttle, followed by the shuttle’s parallel and perpendicular positions relative to the Chou–opponent axis. This transformation allowed me to represent shuttle placement not just in raw court coordinates but in a way that was interpretable in the tactical context of each rally. It distinguished, for example, whether a shot was placed directly in line with the opponent, pulled wide across the court, or targeted into space behind them.  

By the end of this stage, I had transformed the cleaned rally data into a focused, model-ready `final_stroke_data` table. It contained not only the match, set, and rally context, but also the positional and tactical features needed to analyse how Chou’s shot selection and placement influenced rally outcomes.
